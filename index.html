<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="theme-color" content="#BC8887" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Wedding Invitation | Regy & Lina</title>

    <meta
      property="og:title"
      content="Wedding Invitation | Regy & Lina - Day, 15 November 2025"
    />
    <meta
      property="og:description"
      content="Wedding Invitation | Regy & Lina - Saturday, 15 November 2025 at Mandarin Oriental, Taipei"
    />
    <meta property="og:locale" content="en_US" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bulma Version 0.8.x-->
    <link
      rel="stylesheet"
      href="https://unpkg.com/bulma@0.8.0/css/bulma.min.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/bulma-tooltip@0.1.5/dist/bulma-tooltip.min.css"
    />
    <link rel="stylesheet" type="text/css" href="css/menikah.css" />
    <script
      src="https://kit.fontawesome.com/2828f7885a.js"
      integrity="sha384-WAsFbnLEQcpCk8lM1UTWesAf5rGTCvb2Y+8LvyjAAcxK1c3s5c0L+SYOgxvc6PWG"
      crossorigin="anonymous"
    ></script>
    <script
      type="text/javascript"
      src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"
    ></script>
    <link rel="icon" type="image/png" href="image/favicon.png" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'UA-23064379-20');
    </script>

    <!-- Github Button -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
  </head>

  <body>
    <!-- Begin Preloader -->
    <div class="preloader-wrapper">
      <div class="preloader">
        <img src="image/favicon.png" alt="Flower" />
      </div>
    </div>
    <!-- End Preloader-->

    <!-- Begin Header -->
    <div class="header-wrapper" id="home">
      <!-- Begin Hero -->
      <section class="hero is-large">
        <!-- Begin Mobile Nav -->
        <nav class="navbar is-transparent is-hidden-desktop">
          <!-- Begin Burger Menu -->
          <div class="navbar-brand is-fixed-top">
            <div class="navbar-burger burger" data-target="mobile-nav">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </div>
          <!-- End Burger Menu -->
          <div id="mobile-nav" class="navbar-menu">
            <div class="navbar-end">
              <div class="navbar-item">
                <a class="navbar-item" href="#Time">Time</a>
              </div>
              <div class="navbar-item">
                <a class="navbar-item" href="#Location">Location</a>
              </div>
              <div class="navbar-item">
                <a class="navbar-item" href="#rsvp">RSVP</a>
              </div>
            </div>
          </div>
        </nav>
        <!-- End Mobile Nav -->

        <!-- Begin Hero Content-->
        <div class="hero-body">
          <div class="container has-text-centered">
            <h1 class="subtitle">We Got Married!</h1>
            <h2 class="title">Regy & Lina</h2>
            <h4 class="subtitle venue-time">Saturday, 15 November 2025</h4>
          </div>

          <!-- Start Dynamic Countdown -->
          <div>
            <ul id="countdown">
              <li>
                <span class="days">00</span>
                <p class="days_text">Days</p>
              </li>
              <li class="separator">:</li>
              <li>
                <span class="hours">00</span>
                <p class="hours_text">Hours</p>
              </li>
              <li class="separator">:</li>
              <li>
                <span class="minutes">00</span>
                <p class="minutes_text">Minutes</p>
              </li>
              <li class="separator">:</li>
              <li>
                <span class="seconds">00</span>
                <p class="seconds_text">Seconds</p>
              </li>
            </ul>
            <div class="spasi"></div>
          </div>
          <!-- End Countdown -->
        </div>
        <!-- End Hero Content-->

        <!-- Begin Hero Menu -->
        <div class="hero-foot">
          <div class="hero-foot--wrapper">
            <div class="columns">
              <div class="column is-12 hero-menu-desktop has-text-centered">
                <ul>
                  <li class="is-active">
                    <a href="#home">Home</a>
                  </li>
                  <li><a href="#Time">Time</a></li>
                  <li><a href="#Location">Location</a></li>
                  <li><a href="#rsvp">RSVP</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <!-- End Hero Menu -->
      </section>
      <!-- End Hero -->
    </div>
    <!-- End Header -->

    <!-- Begin Main Content -->
    <div class="main-content">
      <!-- Begin invitation-section-->
      <section class="invitation-section">
        <div class="mo-pattern mo-pattern-left"></div>
        <div class="mo-pattern mo-pattern-right"></div>

        <div class="container">
          <div data-aos="fade-up" data-aos-duration="1000">
            <img
              src="image/mandarin-oriental.svg"
              class="mandarin-logo has-text-centered"
              alt="In the name of Allah, the Most Gracious, the Most Merciful"
            />
          </div>

          <div class="invitation-text">
            <h1>èª æ‘¯é‚€è«‹</h1>
            <p>
              è¬¹è¨‚æ–¼ä¸­è¯æ°‘åœ‹ 114 å¹´éœœæœˆä½³æœŸä¹‹éš›<br />
              åœ¨æ­¤è‰¯è¾°å‰æ—¥ï¼Œèª æ‘¯é‚€è«‹æ‚¨è’è‡¨è¦‹è­‰<br />
              æˆ‘å€‘äººç”Ÿä¸­æœ€é‡è¦çš„æ™‚åˆ»
            </p>
          </div>

          <div class="couple-section">
            <div class="groom-side">
              <div class="side-decoration"></div>
              <div class="parent-names">
                æ–°éƒçˆ¶ å¼µéŒ«ç¥¿ å…ˆç”Ÿ<br />
                æ–°éƒæ¯ æ¢ç¾è² å¥³å£«
              </div>
              <div class="couple-name">
                <div class="full-name">å¼µå®¶æ§ƒ</div>
                <div class="full-name">Chia Pan Chang</div>
              </div>
            </div>

            <div class="ampersand">&</div>

            <div class="bride-side">
              <div class="side-decoration"></div>
              <div class="parent-names">
                æ–°å¨˜çˆ¶ è¬æ›œé´» å…ˆç”Ÿ<br />
                æ–°å¨˜æ¯ è”¡ä½³ç‡• å¥³å£«
              </div>
              <div class="couple-name">
                <div class="full-name">è¬è•ç’˜</div>
                <div class="full-name">Chiao Lin Hsieh</div>
              </div>
            </div>
          </div>

          <div class="closing-text">
            <p>
              æ•¬å‚™å–œç­µ æ­å€™å…‰è‡¨<br />
              æ‚¨çš„è’è‡¨å°‡æ˜¯æˆ‘å€‘æœ€å¤§çš„æ¦®å¹¸èˆ‡å–œæ‚…<br />
              è®“æˆ‘å€‘ä¸€åŒè¦‹è­‰æ„›æƒ…çš„ç¾å¥½æ™‚åˆ»
            </p>
          </div>
        </div>
      </section>
      <!-- End invitation-section-->

      <!-- Begin Time Section -->
      <section class="section-dark" id="Time">
        <div class="container">
          <div
            class="column is-12 regular-section"
            data-aos="fade-up"
            data-aos-duration="1000"
          >
            <h1 class="title has-text-centered section-title">Time & Date</h1>
          </div>
          <div class="columns is-multiline">
            <div
              class="column is-4 has-vertically-aligned-content"
              data-aos="fade-up"
              data-aos-duration="1000"
              data-aos-delay="100"
            >
              <p class="is-larger has-text-centered"></p>
              <div class="event-time date-day has-text-centered">Saturday</div>
              <div class="date-number has-text-centered">15</div>
              <div class="event-time date-month has-text-centered">
                November 2025
              </div>
            </div>
            <div
              class="column is-4 has-vertically-aligned-content"
              data-aos="fade-up"
              data-aos-duration="1000"
              data-aos-delay="200"
            >
              <p class="event-time is-larger has-text-centered">
                Wedding Ceremony
                <br />
                <strong>12:00 PM</strong>
              </p>
            </div>
            <div
              class="column is-4 has-vertically-aligned-content"
              data-aos="fade-up"
              data-aos-duration="1000"
              data-aos-delay="300"
            >
              <h1 class="event-time is-larger has-text-centered">
                Reception
                <br />
                <strong>11:30 AM-12:00 PM</strong>
              </h1>
              <div
                class="main-content has-text-centered"
                data-aos="zoom-in"
                data-aos-duration="800"
                data-aos-delay="400"
              >
                <a
                  href="https://calendar.google.com/calendar/render?action=TEMPLATE&text=%E5%A9%9A%E7%A6%AE%E5%9B%8D%E5%AE%B4%E2%94%82%E5%BC%B5%E5%AE%B6%E6%A7%83%20%26%20%E8%AC%9D%E8%95%8E%E7%92%98&dates=20251115T120000/20251115T150000&ctz=Asia%2FTaipei&details=%E8%AC%B9%E8%A8%82%E6%96%BC%E6%B0%91%E5%9C%8B%20114%20%E5%B9%B4%2011%20%E6%9C%88%2015%20%E6%97%A5%EF%BC%88%E6%98%9F%E6%9C%9F%E5%85%AD%EF%BC%89%E4%B8%AD%E5%8D%88%2012%20%E6%99%82%EF%BC%8C%0A%E5%81%87%E8%87%BA%E5%8C%97%E5%B8%82%E6%9D%BE%E5%B1%B1%E5%8D%80%E6%95%A6%E5%8C%96%E5%8C%97%E8%B7%AF%20158%20%E8%99%9F%E3%80%90%E6%96%87%E8%8F%AF%E6%9D%B1%E6%96%B9%E9%85%92%E5%BA%97%E3%80%91%E8%88%89%E8%A1%8C%E5%A9%9A%E7%A6%AE%E5%9B%8D%E5%AE%B4%EF%BC%8C%0A%E8%AA%A0%E6%91%AF%E9%82%80%E8%AB%8B%E6%82%A8%E8%92%9E%E8%87%A8%EF%BC%8C%E8%88%87%E6%88%91%E5%80%91%E4%B8%80%E5%90%8C%E8%A6%8B%E8%AD%89%E5%B9%B8%E7%A6%8F%E6%99%82%E5%88%BB%EF%BC%81&location=%E8%87%BA%E5%8C%97%E5%B8%82%E6%9D%BE%E5%B1%B1%E5%8D%80%E6%95%A6%E5%8C%96%E5%8C%97%E8%B7%AF%20158%20%E8%99%9F%20%E6%96%87%E8%8F%AF%E6%9D%B1%E6%96%B9%E9%85%92%E5%BA%97"
                  target="_blank"
                  class="button has-tooltip btn-cta"
                  data-tooltip="Add to Calendar"
                  target="_blank"
                >
                  <i class="far fa-calendar-plus"></i>
                  Google Calendar
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- End Time Content -->

      <!-- Begin Location Section -->
      <section class="section-darker" id="Location">
        <div class="container">
          <div
            class="column is-12 regular-section"
            data-aos="fade-up"
            data-aos-duration="1000"
          >
            <h1 class="title has-text-centered section-title">Location</h1>
            <p
              class="venue is-larger has-text-centered"
              data-aos="fade-up"
              data-aos-duration="1000"
              data-aos-delay="100"
            >
              <strong>å°åŒ—æ–‡è¯æ±æ–¹é…’åº—</strong>
              <br />
              å°åŒ—å¸‚æ¾å±±å€æ•¦åŒ–åŒ—è·¯158è™Ÿ
              <br />
              æ–‡è¯å»³
              <br />
            </p>
          </div>
          <div
            class="section-map"
            data-aos="fade-up"
            data-aos-duration="1000"
            data-aos-delay="200"
          >
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3614.426833339097!2d121.54929407601135!3d25.05349253721384!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3442abadec711273%3A0x3775463346d479e0!2sMandarin%20Oriental%2C%20Taipei!5e0!3m2!1sen!2stw!4v17208585822 Mandarin%20Oriental"
              width="100%"
              height="450"
              frameborder="0"
              style="border: 0"
              allowfullscreen=""
              loading="lazy"
            ></iframe>
          </div>
          <div class="space40px"></div>
          <div
            class="has-text-centered"
            data-aos="zoom-in"
            data-aos-duration="800"
            data-aos-delay="300"
          >
            <a
              href="https://www.google.com/maps/place/Mandarin+Oriental,+Taipei/@25.0557416,121.5455736,17z/data=!3m1!5s0x3442abe61bd3e237:0xab7f44c0a8e54b79!4m9!3m8!1s0x3442abe619567959:0x5ca150e7d0fc4834!5m2!4m1!1i2!8m2!3d25.0557416!4d121.5481485!16s%2Fg%2F11b6mnxhyb?entry=ttu&g_ep=EgoyMDI1MDcwOS4wIKXMDSoASAFQAw%3D%3D"
              class="button btn-cta"
              target="_blank"
            >
              <i class="far fa-directions"></i>
              Google Maps
            </a>
          </div>
        </div>
      </section>
      <!-- End Location Content -->

      <!-- Begin RSVP Content -->
      <section class="section-dark contact" id="rsvp">
        <div class="container">
          <div class="rsvp-section">
            <div class="corner-ornament top-left"></div>
            <div class="corner-ornament bottom-right"></div>

            <h1>æ•¬è«‹å›è¦†å‡ºå¸­æ„é¡˜</h1>
            <p class="subtitle">
              èª æ‘¯é‚€è«‹æ‚¨æ–¼<br />
              2025 å¹´ 08 æœˆ 31 æ—¥å‰å›è¦†
            </p>

            <div class="divider"></div>

            <button class="rsvp-button" onclick="showForm()">ç«‹å³å›è¦†</button>

            <div id="rsvpForm" class="form-container">
              <form id="rsvp-form" onsubmit="handleSubmit(event)">
                <div class="form-row">
                  <div class="form-group">
                    <label for="name">å§“å *</label>
                    <input
                      type="text"
                      id="name"
                      name="entry.684992261"
                      required
                    />
                  </div>
                </div>

                <!-- Fields to be toggled -->
                <div id="attending-fields">
                  <div class="form-row">
                    <div class="form-group">
                      <label for="email">é›»å­éƒµä»¶</label>
                      <input type="email" id="email" name="entry.1641189894" />
                    </div>
                  </div>

                  <div class="form-group">
                    <label>æ˜¯å¦é¡˜é ˜ç´™æœ¬å–œå¸–ï¼Ÿ</label>
                    <div class="radio-group">
                      <label class="radio-label">
                        <input
                          type="radio"
                          id="receiveInvitation"
                          name="entry.753027985"
                          value="æ˜¯"
                          onchange="toggleAddressField()"
                        />
                        é¡˜æ„é ˜å–
                      </label>
                      <label class="radio-label">
                        <input
                          type="radio"
                          id="noInvitation"
                          name="entry.753027985"
                          value="å¦"
                          checked
                          onchange="toggleAddressField()"
                        />
                        æ²’æœ‰é—œä¿‚
                      </label>
                    </div>
                  </div>

                  <div
                    id="addressField"
                    class="form-group"
                    style="display: none"
                  >
                    <label for="address">æ”¶ä»¶åœ°å€</label>
                    <input type="text" id="address" name="entry.1550140398" />
                  </div>
                </div>

                <!-- Attendance Toggle -->
                <div class="form-group">
                  <label>æ˜¯å¦èƒ½è’è‡¨åƒèˆ‡ï¼Ÿ *</label>
                  <div class="radio-group">
                    <label class="radio-label">
                      <input
                        type="radio"
                        id="attendingYes"
                        name="entry.412065303"
                        value="yes"
                        required
                        onchange="handleAttendanceChange()"
                      />
                      æ¬£ç„¶å‡ºå¸­
                    </label>
                    <label class="radio-label">
                      <input
                        type="radio"
                        id="attendingNo"
                        name="entry.412065303"
                        value="no"
                        required
                        onchange="handleAttendanceChange()"
                      />
                      ç„¡æ³•å‡ºå¸­
                    </label>
                  </div>
                </div>

                <!-- Guest Details (for attending guests) -->
                <div id="guestDetails" style="display: none">
                  <div class="form-group">
                    <label for="guestCount">å‡ºå¸­äººæ•¸ *</label>
                    <input
                      type="number"
                      id="guestCount"
                      name="guestCount"
                      min="1"
                      max="10"
                      value="1"
                      onchange="updateMaxDietary()"
                      required
                    />
                  </div>

                  <div class="form-group">
                    <div class="dietary-section">
                      <label>ç”¨é¤äººæ•¸åˆ†é… *</label>
                      <div class="dietary-inputs">
                        <div class="dietary-item">
                          <label for="regularCount">è‘·ï¼š</label>
                          <input
                            type="number"
                            id="regularCount"
                            name="entry.1876515129"
                            min="0"
                            max="1"
                            value="1"
                            onchange="validateDietaryCount()"
                          />
                        </div>
                        <div class="dietary-item">
                          <label for="vegetarianCount">ç´ ï¼š</label>
                          <input
                            type="number"
                            id="vegetarianCount"
                            name="entry.1942737676"
                            min="0"
                            max="1"
                            value="0"
                            onchange="validateDietaryCount()"
                          />
                        </div>
                      </div>
                      <div class="total-info">
                        <div class="total-row">
                          <span>ç”¨é¤ç¸½äººæ•¸ï¼š</span>
                          <span class="total-count" id="totalDietaryCount"
                            >1</span
                          >
                        </div>
                      </div>
                      <div class="error-message" id="dietaryError">
                        ç”¨é¤äººæ•¸ç¸½å’Œå¿…é ˆç­‰æ–¼å‡ºå¸­äººæ•¸
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="allergies">é£Ÿç‰©éæ•æˆ–ç‰¹æ®Šéœ€æ±‚</label>
                    <textarea
                      id="allergies"
                      name="entry.1414163675"
                      rows="3"
                      placeholder="å¦‚æœ‰ä»»ä½•ç‰¹æ®Šé£²é£Ÿéœ€æ±‚æˆ–éœ€è¦å…’ç«¥åº§æ¤…ï¼Œæ•¬è«‹å‘ŠçŸ¥ (*Â´âˆ€`)~â™¥"
                    ></textarea>
                  </div>
                </div>

                <!-- Special Message (now independent) -->
                <div
                  class="form-group"
                  id="specialMessageGroup"
                  style="display: none"
                >
                  <label for="specialMessage">çµ¦æ–°äººçš„ç¥ç¦</label>
                  <textarea
                    id="specialMessage"
                    name="entry.164157053"
                      rows="4"
                      placeholder="æ­¡è¿ç•™è¨€æ‚¨çš„ç¾å¥½ç¥ç¦
Î£>â€•(ã€ƒÂ°Ï‰Â°ã€ƒ)â™¡â†’"
                  ></textarea>
                </div>

                <button type="submit" class="submit-button" id="submitBtn">
                  é€å‡ºå›è¦†
                </button>
              </form>
              <!-- ===== FORM END ===== -->

              <!-- ===== MESSAGES START ===== -->
              <div id="successMessage" class="message" style="display: none">
                æ„Ÿè¬æ‚¨çš„å›è¦†ï¼ŒæœŸå¾…èˆ‡æ‚¨å…±è¥„ç››èˆ‰ï¼
              </div>
              <div
                id="errorMessage"
                class="message error"
                style="display: none"
              >
                é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–ç›´æ¥è¯ç¹« hi@regy.devã€‚
              </div>
              <!-- ===== MESSAGES END ===== -->
            </div>
          </div>
        </div>
      </section>
      <!-- End RSVP Content -->
    </div>
    <!-- End Main Content -->

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/menikah.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <!-- Dynamic Countdown Script -->
    <script>
      // Wedding date configuration - CHANGE THIS TO YOUR WEDDING DATE
      const WEDDING_DATE = new Date('2025-11-15T12:00:00').getTime(); // November 15, 2025 at 12:00 PM

      // Function to add leading zeros
      function addLeadingZero(num) {
        return num < 10 ? '0' + num : num;
      }

      // Function to update countdown with smooth transitions
      function updateCountdown() {
        const now = new Date().getTime();
        const timeLeft = WEDDING_DATE - now;

        if (timeLeft < 0) {
          document.getElementById('countdown').innerHTML =
            '<div class="countdown-finished">ğŸ‰ The Wedding Day Has Arrived! ğŸ‰</div>';
          return;
        }

        const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        const hours = Math.floor(
          (timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
        );
        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);

        document.querySelector('.days').textContent = addLeadingZero(days);
        document.querySelector('.hours').textContent = addLeadingZero(hours);
        document.querySelector('.minutes').textContent =
          addLeadingZero(minutes);
        document.querySelector('.seconds').textContent =
          addLeadingZero(seconds);

        document.querySelector('.days_text').textContent =
          days === 1 ? 'Day' : 'Days';
        document.querySelector('.hours_text').textContent =
          hours === 1 ? 'Hour' : 'Hours';
        document.querySelector('.minutes_text').textContent =
          minutes === 1 ? 'Minute' : 'Minutes';
        document.querySelector('.seconds_text').textContent =
          seconds === 1 ? 'Second' : 'Seconds';
      }

      document.addEventListener('DOMContentLoaded', function () {
        updateCountdown();
        setInterval(updateCountdown, 1000);
        AOS.init({
          duration: 800,
          easing: 'ease-out-cubic',
          once: false,
          offset: 50,
        });

        window.addEventListener('load', function () {
          setTimeout(function () {
            const preloader = document.querySelector('.preloader-wrapper');
            if (preloader) {
              preloader.style.opacity = '0';
              setTimeout(function () {
                preloader.style.display = 'none';
              }, 500);
            }
          }, 500);
        });

        updateMaxDietary();
      });

      // --- RSVP FORM LOGIC ---

      function toggleAddressField() {
        var addressField = document.getElementById('addressField');
        if (document.getElementById('receiveInvitation').checked) {
          addressField.style.display = 'block';
        } else {
          addressField.style.display = 'none';
        }
      }

      function showForm() {
        document.getElementById('rsvpForm').style.display = 'block';
        document.querySelector('.rsvp-button').style.display = 'none';
      }

      function handleAttendanceChange() {
        const isAttending = document.getElementById('attendingYes').checked;
        const isNotAttending = document.getElementById('attendingNo').checked;

        const attendingFields = document.getElementById('attending-fields');
        const guestDetails = document.getElementById('guestDetails');
        const specialMessageGroup = document.getElementById(
          'specialMessageGroup'
        );
        const specialMessageTextarea =
          document.getElementById('specialMessage');

        // Inputs that have validation
        const guestCountInput = document.getElementById('guestCount');

        if (isAttending) {
          attendingFields.style.display = 'block';
          guestDetails.style.display = 'block';
          specialMessageGroup.style.display = 'block';
          specialMessageTextarea.placeholder =
            'æ­¡è¿ç•™è¨€æ‚¨çš„ç¾å¥½ç¥ç¦\nÎ£>â€•(ã€ƒÂ°Ï‰Â°ã€ƒ)â™¡â†’';
          guestCountInput.required = true;
          toggleAddressField();
        } else if (isNotAttending) {
          // attendingFields.style.display = 'none';
          guestDetails.style.display = 'none';
          specialMessageGroup.style.display = 'block';
          specialMessageTextarea.placeholder =
            'å¾ˆéºæ†¾æ‚¨ç„¡æ³•åƒåŠ ï¼Œä½†æ‚¨çš„ç¥ç¦å°æˆ‘å€‘åŒæ¨£é‡è¦ï¼Œæ­¡è¿åœ¨æ­¤ç•™ä¸‹æ‚¨çš„ç¥ç¦ï¼';
          guestCountInput.required = false;
        }
      }

      function updateMaxDietary() {
        const guestCount =
          parseInt(document.getElementById('guestCount').value) || 1;
        const vegetarianInput = document.getElementById('vegetarianCount');
        const regularInput = document.getElementById('regularCount');
        vegetarianInput.max = guestCount;
        regularInput.max = guestCount;
        if (
          parseInt(regularInput.value) + parseInt(vegetarianInput.value) >
          guestCount
        ) {
          regularInput.value = guestCount;
          vegetarianInput.value = 0;
        }
        validateDietaryCount();
      }

      function validateDietaryCount() {
        const guestCount =
          parseInt(document.getElementById('guestCount').value) || 1;
        const vegetarianCount =
          parseInt(document.getElementById('vegetarianCount').value) || 0;
        const regularCount =
          parseInt(document.getElementById('regularCount').value) || 0;
        const totalDietary = vegetarianCount + regularCount;
        document.getElementById('totalDietaryCount').textContent = totalDietary;
        const errorElement = document.getElementById('dietaryError');
        const submitBtn = document.getElementById('submitBtn');

        if (totalDietary !== guestCount) {
          errorElement.style.display = 'block';
          submitBtn.disabled = true;
          if (totalDietary > guestCount) {
            errorElement.textContent = `ç”¨é¤äººæ•¸ç¸½å’Œ (${totalDietary}) è¶…éå‡ºå¸­äººæ•¸ (${guestCount})`;
          } else {
            errorElement.textContent = `ç”¨é¤äººæ•¸ç¸½å’Œ (${totalDietary}) å°‘æ–¼å‡ºå¸­äººæ•¸ (${guestCount})`;
          }
        } else {
          errorElement.style.display = 'none';
          submitBtn.disabled = false;
        }
      }

      async function handleSubmit(event) {
        event.preventDefault();

        const SCRIPT_URL =
          'https://docs.google.com/forms/d/e/1FAIpQLSfTS3aAcDsKzRa9ybV6fftj4XNMcb8ItlPcAkcNif8eh6prhQ/formResponse';

        const form = document.getElementById('rsvp-form');
        const submitBtn = document.getElementById('submitBtn');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');

        // --- Validation ---
        if (document.getElementById('attendingYes').checked) {
          const guestCount =
            parseInt(document.getElementById('guestCount').value) || 1;
          const vegetarianCount =
            parseInt(document.getElementById('vegetarianCount').value) || 0;
          const regularCount =
            parseInt(document.getElementById('regularCount').value) || 0;

          if (vegetarianCount + regularCount !== guestCount) {
            // This check is redundant if the button is properly disabled, but serves as a final safeguard.
            document.getElementById('dietaryError').style.display = 'block';
            return;
          }
        }

        // --- Submission ---
        submitBtn.disabled = true;
        submitBtn.textContent = 'å‚³é€ä¸­...';
        errorMessage.style.display = 'none';

        const formData = new FormData(form);

        // If not attending, clear irrelevant fields to avoid sending empty/zero values
        if (document.getElementById('attendingNo').checked) {
          formData.set('entry.1876515129', '0'); // Regular Count
          formData.set('entry.1942737676', '0'); // Vegetarian Count
          formData.set('entry.1414163675', ''); // Notes
        }

        try {
          // We use 'no-cors' mode because Google Forms doesn't allow cross-origin requests.
          // This means we can't read the response, but the form submission will still go through.
          await fetch(SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            body: new URLSearchParams(formData),
          });

          // If the fetch doesn't throw an error, we assume it was successful.
          form.style.display = 'none';
          successMessage.style.display = 'block';
          errorMessage.style.display = 'none';

          // Update success message based on attendance
          if (document.getElementById('attendingNo').checked) {
            successMessage.textContent = 'æ„Ÿè¬æ‚¨çš„å›è¦†èˆ‡ç¥ç¦ï¼';
          } else {
            successMessage.textContent = 'æ„Ÿè¬æ‚¨çš„å›è¦†ï¼ŒæœŸå¾…èˆ‡æ‚¨å…±è¥„ç››èˆ‰ï¼';
          }
        } catch (error) {
          console.error('Error submitting form:', error);
          errorMessage.style.display = 'block';
          submitBtn.disabled = false;
          submitBtn.textContent = 'é€å‡ºå›è¦†';
        }
      }
    </script>
  </body>
</html>
